# 🚨 **Apps Script v6.2.12 긴급 배포 - 올바른 시트 이름**

## ⚠️ **문제 발견!**

### 잘못된 시트 이름 사용
- ❌ **v6.2.11**: `'사근복컨설턴트(매니저)'` (실제로 존재하지 않음!)
- ✅ **실제 시트 이름**: `'사근복매니저'`

### 영향 범위
- ❌ 매니저 조회 불가
- ❌ 매니저 로그인 불가
- ❌ 매니저 가입 불가
- ❌ 추천인 검증 실패 (매니저 이름 찾을 수 없음)

---

## ✅ **v6.2.12 수정 사항**

### 올바른 시트 이름
```javascript
// Before (v6.2.11) - 잘못됨 ❌
'사근복컨설턴트(매니저)'  // 존재하지 않음!

// After (v6.2.12) - 수정됨 ✅
'사근복매니저'            // 실제 시트 이름
'사근복컨설턴트'          // 이미 정상
```

### 수정된 함수
1. ✅ `loginConsultant()` - 매니저 로그인
2. ✅ `registerManager()` - 매니저 가입
3. ✅ `registerCompany()` - 추천인 검증 (매니저 이름 찾기)
4. ✅ `getAllMembers()` - 매니저 목록 조회
5. ✅ `updateMemberStatus()` - 매니저 상태 변경
6. ✅ `testReferrerValidation()` - 추천인 목록 확인

---

## 🚀 **즉시 배포 방법**

### 1단계: 코드 복사
```bash
cat /home/user/webapp/APPS_SCRIPT_V6.2.12_CORRECT_SHEET_NAMES.js
```

### 2단계: Apps Script 에디터
1. https://script.google.com/home
2. 사근복 프로젝트 열기
3. **Ctrl+A** (전체 선택)
4. **Ctrl+V** (새 코드 붙여넣기)
5. **Ctrl+S** (저장)

### 3단계: 배포
1. 우측 상단 **"배포"** → **"배포 관리"**
2. **"수정"** (연필 아이콘)
3. **"버전"** → **"새 버전"**
4. **"설명"**: `v6.2.12 - 올바른 시트 이름으로 수정 (사근복매니저, 사근복컨설턴트)`
5. **"배포"** 클릭

### 4단계: 확인
```bash
curl -L 'https://script.google.com/macros/s/AKfycbyULZORS2SzTBYYTK_r_5Kd5Q-I3nELI4RbDim1THqGIX8IT0PiAL-BL2oqomf16ate/exec'
```

**예상 응답**:
```json
{
  "success": true,
  "version": "6.2.12",
  "message": "사근복 AI Apps Script v6.2.12 - 올바른 시트 이름으로 수정 (사근복매니저, 사근복컨설턴트)"
}
```

---

## 🧪 **테스트 방법**

### 1️⃣ 시트 이름 확인 (Apps Script 에디터)
```javascript
testReferrerValidation()  // 실행
```

**예상 결과**:
```
매니저 시트 행 수: 2
  매니저 1: [이름] ([이메일])
  매니저 2: [이름] ([이메일])
컨설턴트 시트 행 수: 2
  컨설턴트 1: [이름] ([이메일])
  컨설턴트 2: [이름] ([이메일])
```

### 2️⃣ 관리자 대시보드 테스트
```
1. 로그인: 01063529091 / 12345
2. "👨‍💼 매니저" 탭 클릭
   ✅ 예상: 2명 표시
3. "👔 컨설턴트" 탭 클릭
   ✅ 예상: 2명 표시
```

### 3️⃣ 추천인 검증 테스트
```
1. 회원가입 페이지
2. 기업회원 선택
3. 추천인: [testReferrerValidation에서 확인한 매니저 이름]
4. 회원가입 클릭
```

**예상 결과**:
- ✅ "회원가입이 완료되었습니다. 관리자 승인 후 로그인 가능합니다."
- 📧 3개 이메일 발송 (회원, 추천인, 관리자)

---

## 📊 **수정 전후 비교**

| 항목 | v6.2.11 (잘못됨) | v6.2.12 (수정됨) |
|------|------------------|------------------|
| **매니저 시트 이름** | '사근복컨설턴트(매니저)' ❌ | '사근복매니저' ✅ |
| **컨설턴트 시트 이름** | '사근복컨설턴트' ✅ | '사근복컨설턴트' ✅ |
| **매니저 조회** | 0명 표시 ❌ | 2명 표시 ✅ |
| **매니저 로그인** | 실패 ❌ | 성공 ✅ |
| **추천인 검증 (매니저)** | 실패 ❌ | 성공 ✅ |

---

## 🔍 **v6.2.12 전체 기능**

### v6.2.12 = v6.2.11 + 올바른 시트 이름

| 기능 | 상태 |
|------|------|
| ✅ 올바른 시트 이름 | **신규 수정** |
| ✅ 매니저 2명 조회 | 정상 |
| ✅ 컨설턴트 2명 조회 | 정상 |
| ✅ 회원가입 후 JSON 자동 동기화 | 정상 |
| ✅ 상태 변경 후 JSON 자동 동기화 | 정상 |
| ✅ 이메일 발송 (회원가입) | 정상 |
| ✅ 이메일 발송 (승인/거부) | 정상 |
| ✅ 추천인 검증 (기업회원) | 정상 |
| ✅ 발송자명: TY사근복헬스케어사업단 | 정상 |
| ✅ 승인 대기 상태 | 정상 |

---

## 🚨 **긴급 배포 권장**

**이유:**
- v6.2.11은 **매니저 기능이 작동하지 않음**
- 잘못된 시트 이름으로 매니저 관련 모든 기능 실패
- v6.2.12로 즉시 배포 필요

**우선순위:** 🔴 **긴급**

---

## 📝 **확인 체크리스트**

배포 후 반드시 확인:

- [ ] ✅ 버전 확인: `curl` 응답에서 v6.2.12 확인
- [ ] ✅ `testReferrerValidation()`: 매니저 2명 표시
- [ ] ✅ 관리자 대시보드: "매니저" 탭에서 2명 표시
- [ ] ✅ 관리자 대시보드: "컨설턴트" 탭에서 2명 표시
- [ ] ✅ 추천인 검증: 매니저 이름으로 가입 성공
- [ ] ✅ 이메일 발송: 추천인에게 이메일 수신 확인

---

## 💡 **중요 사항**

### Google Sheets 시트 이름 확인
실제 Google Sheets에서 시트 이름을 확인하세요:
```
1. Spreadsheet 열기
2. 하단 시트 탭 확인
   ✅ '사근복매니저' (관호 없음!)
   ✅ '사근복컨설턴트'
   ✅ '기업회원'
   ✅ '로그'
```

### 시트 이름이 다르면
만약 실제 시트 이름이 다르면 알려주세요:
- Google Sheets 하단 탭의 정확한 이름
- 스크린샷 또는 텍스트로

---

**지금 즉시 v6.2.12를 배포하세요!** 🚀

```bash
cat /home/user/webapp/APPS_SCRIPT_V6.2.12_CORRECT_SHEET_NAMES.js
```
