# 🧪 회원가입 시트 연동 테스트 가이드

## ✅ 준비 완료

### 📊 Google Sheets
**URL:** https://docs.google.com/spreadsheets/d/1NzBVwAjDTSQWznBapoD1fGspUvXpvQsozdJVSEF5Atc/edit

**Spreadsheet ID:** `1NzBVwAjDTSQWznBapoD1fGspUvXpvQsozdJVSEF5Atc`

### 🔧 백엔드 API
**URL:** https://script.google.com/macros/s/AKfycbwB26bKC8LI0MVYdmGptMYEXeiD4XtbrI5jsbxWheQbpBstq4ECHGQ_YfrhvEoOFKIM4g/exec

**버전:** 2.1

**기능:**
- ✅ 로그기록
- ✅ 승인여부
- ✅ 추천인검증
- ✅ 컨설턴트비밀번호저장

---

## 🎯 테스트 방법 (3가지)

### 방법 1: Google Apps Script 편집기에서 직접 테스트 (권장 ⭐)

#### Step 1: Apps Script 편집기 열기
1. Google Sheets 열기: https://docs.google.com/spreadsheets/d/1NzBVwAjDTSQWznBapoD1fGspUvXpvQsozdJVSEF5Atc/edit
2. 상단 메뉴: 확장 프로그램 → Apps Script

#### Step 2: TEST_FUNCTIONS.gs 코드 추가
1. 좌측 파일 목록에서 "+" 버튼 클릭
2. "스크립트" 선택
3. 파일명: `TEST_FUNCTIONS`
4. `/home/user/webapp/google-apps-script/TEST_FUNCTIONS.gs` 파일 내용 복사 붙여넣기
5. 저장 (Ctrl+S)

#### Step 3: 테스트 실행
1. 상단 함수 선택 드롭다운에서 `runAllTests` 선택
2. "실행" 버튼 클릭 (▶️)
3. 권한 승인 (처음 실행 시만)
4. 실행 로그 확인 (Ctrl+Enter 또는 보기 → 로그)

#### Step 4: 결과 확인
1. Google Sheets로 돌아가기
2. 사근복컨설턴트 시트 확인
   - 홍길동 데이터가 추가되었는지 확인
   - 승인여부를 "승인완료"로 변경
3. 기업회원 시트 확인
   - 김철수 데이터가 추가되었는지 확인
   - 승인여부를 "승인완료"로 변경

#### Step 5: 로그인 테스트
1. Apps Script 편집기로 돌아가기
2. 함수 선택: `testLoginConsultant`
3. 실행 → 로그 확인
4. 함수 선택: `testLoginCompany`
5. 실행 → 로그 확인

---

### 방법 2: 웹 브라우저에서 테스트 페이지 사용

#### Step 1: 테스트 페이지 접속
```
https://8000-ibupgf3p7cll7kpgwy3n6-0e616f0a.sandbox.novita.ai/test-signup-api.html
```

#### Step 2: 순서대로 버튼 클릭
1. "백엔드 상태 확인" → 정상 작동 확인
2. "홍길동 컨설턴트 가입" → 결과 확인
3. Google Sheets에서 승인여부 변경
4. "홍길동 로그인" → 성공 확인
5. "김철수 기업회원 가입" → 결과 확인
6. Google Sheets에서 승인여부 변경
7. "김철수 로그인" → 성공 확인

⚠️ **주의:** CORS 제한으로 인해 응답을 볼 수 없을 수 있습니다. Google Sheets를 직접 확인하세요!

---

### 방법 3: 메인 앱에서 실제 UI로 테스트

#### Step 1: 메인 앱 접속
```
https://8000-ibupgf3p7cll7kpgwy3n6-0e616f0a.sandbox.novita.ai
```

#### Step 2: 컨설턴트 회원가입
1. "회원가입" 탭 클릭
2. "컨설턴트" 선택
3. 정보 입력:
   - 이름: 홍길동
   - 전화번호: 010-8765-4321
   - 이메일: hong@sagunbok.com
   - 직함: 수석 컨설턴트
   - 소속사업단: 서울사업단
   - 소속지사: 강남지사
4. "회원가입" 버튼 클릭
5. 성공 메시지 확인

#### Step 3: Google Sheets에서 승인
1. Google Sheets 열기
2. 사근복컨설턴트 시트로 이동
3. 홍길동 찾기 (2행)
4. I열(승인여부): "대기중" → "승인완료"로 변경

#### Step 4: 컨설턴트 로그인
1. "로그인" 탭으로 이동
2. "컨설턴트" 선택
3. 전화번호: 010-8765-4321
4. 비밀번호: 12345
5. "로그인" 버튼 클릭
6. 메인 앱으로 이동 확인
7. 왼쪽 사이드바에 "홍길동" 표시 확인

#### Step 5: 기업회원 가입
1. 로그아웃
2. "회원가입" 탭 클릭
3. "기업회원" 선택
4. 정보 입력:
   - 회사명: 테스트주식회사
   - 기업회원분류: 법인
   - 추천인: 홍길동 ⭐
   - 이름: 김철수
   - 전화번호: 010-1234-5678
   - 이메일: test@company.com
   - 비밀번호: test1234
   - 비밀번호 확인: test1234
5. "회원가입" 버튼 클릭
6. 성공 메시지 확인

#### Step 6: Google Sheets에서 승인
1. 기업회원 시트로 이동
2. 김철수 찾기
3. I열(승인여부): "대기중" → "승인완료"로 변경

#### Step 7: 기업회원 로그인
1. "로그인" 탭으로 이동
2. "기업회원" 선택 (기본값)
3. 전화번호: 010-1234-5678
4. 비밀번호: test1234
5. "로그인" 버튼 클릭
6. 메인 앱으로 이동 확인
7. 왼쪽 사이드바에 "김철수" 표시 확인

---

## 📊 예상 결과

### ✅ 컨설턴트 가입 성공 시

**Google Sheets - 사근복컨설턴트 시트:**
```
A: 홍길동
B: 010-8765-4321
C: hong@sagunbok.com
D: 수석 컨설턴트
E: 서울사업단
F: 강남지사
G: 12345 (자동 설정)
H: 2026-01-21 (자동 설정)
I: 대기중 (자동 설정)
J: [2026-01-21 HH:MM:SS] 회원가입 완료
```

### ✅ 기업회원 가입 성공 시

**Google Sheets - 기업회원 시트:**
```
A: 테스트주식회사
B: 법인
C: 홍길동
D: 김철수
E: 010-1234-5678
F: test@company.com
G: test1234
H: 2026-01-21 (자동 설정)
I: 대기중 (자동 설정)
J: [2026-01-21 HH:MM:SS] 회원가입 완료
```

### ✅ 로그인 성공 시

**로그 기록 업데이트:**
```
J: [2026-01-21 HH:MM:SS] 회원가입 완료
   [2026-01-21 HH:MM:SS] 로그인 성공
```

---

## 🔍 검증 포인트

### ✅ 확인할 사항
- [ ] 백엔드 API 정상 작동 (헬스체크)
- [ ] 컨설턴트 회원가입 성공
- [ ] Google Sheets에 데이터 저장
- [ ] 자동 비밀번호 설정 (12345)
- [ ] 승인여부 초기화 (대기중)
- [ ] 로그 기록 자동 추가
- [ ] 추천인 검증 작동
- [ ] 추천인이 컨설턴트 시트에 존재해야 함
- [ ] 추천인의 승인여부가 "승인완료"여야 함
- [ ] 기업회원 가입 성공
- [ ] 로그인 성공
- [ ] 로그 기록 업데이트

### ❌ 테스트할 오류 케이스
- [ ] 중복 전화번호로 가입 시도 → 오류 발생
- [ ] 중복 이메일로 가입 시도 → 오류 발생
- [ ] 잘못된 추천인으로 가입 시도 → "등록되지 않은 추천인" 오류
- [ ] 미승인 추천인으로 가입 시도 → "추천인이 승인되지 않음" 오류
- [ ] 미승인 계정으로 로그인 시도 → "승인 대기 중" 오류
- [ ] 잘못된 비밀번호로 로그인 → "비밀번호 오류"

---

## 🎯 추천 테스트 순서

### 🥇 가장 빠른 방법 (Apps Script 편집기)
1. ✅ Google Sheets 열기
2. ✅ Apps Script 편집기 열기
3. ✅ TEST_FUNCTIONS.gs 추가
4. ✅ runAllTests() 실행
5. ✅ Google Sheets에서 결과 확인
6. ✅ 승인여부 변경
7. ✅ 로그인 테스트 함수 실행

### 🥈 가장 정확한 방법 (실제 UI)
1. ✅ 메인 앱 접속
2. ✅ 회원가입 UI로 실제 테스트
3. ✅ Google Sheets 확인
4. ✅ 승인 처리
5. ✅ 로그인 테스트

### 🥉 가장 빠른 확인 (테스트 페이지)
1. ✅ 테스트 페이지 접속
2. ✅ 버튼 클릭으로 빠른 테스트
3. ✅ Google Sheets 직접 확인

---

## 🚨 문제 해결

### 문제 1: "추천인이 존재하지 않습니다" 오류
**원인:** 컨설턴트 시트에 추천인 이름이 없음

**해결:**
1. 먼저 컨설턴트를 가입시키세요
2. 컨설턴트 시트의 A열에 정확히 일치하는 이름이 있는지 확인

### 문제 2: "추천인이 승인되지 않았습니다" 오류
**원인:** 추천인 컨설턴트의 승인여부가 "승인완료"가 아님

**해결:**
1. 사근복컨설턴트 시트 열기
2. 해당 컨설턴트의 I열(승인여부) 확인
3. "승인완료"로 변경

### 문제 3: "승인 대기 중인 계정입니다" 오류
**원인:** 로그인하려는 계정의 승인여부가 "대기중"

**해결:**
1. 해당 시트 열기 (기업회원 또는 사근복컨설턴트)
2. I열(승인여부)를 "승인완료"로 변경

### 문제 4: CORS 오류
**원인:** Google Apps Script의 CORS 정책

**해결:**
1. Apps Script 편집기에서 직접 테스트 (방법 1)
2. 또는 실제 UI에서 테스트 (방법 3)

---

## 🎉 테스트 완료!

모든 테스트가 성공하면:
1. ✅ 백엔드 API 정상 작동
2. ✅ 회원가입 시스템 작동
3. ✅ Google Sheets 연동 성공
4. ✅ 추천인 검증 작동
5. ✅ 승인 시스템 작동
6. ✅ 로그 기록 작동
7. ✅ 로그인 시스템 작동

**다음 단계:**
- EC2 서버에 배포
- 운영 환경 테스트
- 실제 사용자 테스트

---

## 📞 지원

문제가 발생하면:
1. Google Sheets 데이터 확인
2. Apps Script 실행 로그 확인 (Ctrl+Enter)
3. 브라우저 콘솔 확인 (F12)
4. 이 가이드의 문제 해결 섹션 참조

**🚀 지금 바로 테스트를 시작하세요!**
