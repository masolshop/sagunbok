# 🎉 CEO 절세계산기 V2 통합 완료!

## ✅ 배포 상태

| 항목 | 상태 |
|-----|------|
| **빌드** | ✅ 성공 (664.44 kB) |
| **EC2 배포** | ✅ 완료 |
| **Nginx** | ✅ 재시작 완료 |
| **Git 커밋** | ✅ 완료 (29ecd2a) |
| **GitHub PR** | ✅ 업데이트됨 |

---

## 🚀 새로운 기능

### 1. 종합 시뮬레이션 엔진
```
📊 법인세 절감 (연)
💰 대표 종합소득세 절감 (연/월)
👑 승계세 절감 (증여/상속)
⚖️ 리스크 프로파일 진단
```

### 2. 주식가치 평가 (보충적 평가법)
- **순자산가치**: 자산 - 부채 / 발행주식수
- **수익가치**: 최근 3년 EPS 가중평균 × 환원배수
- **최종 평가**: 순자산가치 × 40% + 수익가치 × 60%
- **자동 조정**: 부동산 과다보유 시 순자산 비중 ↑

### 3. 세금 계산 엔진
```typescript
// 법인세
법인세 절감 = 출연금액 × 유효세율 (22%)

// 종합소득세 (누진)
과표 감소 = 출연금액 × 비용인정률 × 지급방식계수
절감액 = 기존세액 - 감소후세액 + 지방소득세(10%)

// 승계세 (증여/상속)
평가액 = 1주당 가치 × 승계 주식수
과표 = 평가액 - 가업승계공제
승계세 = 누진세율 적용
```

### 4. 리스크 프로파일 진단
```typescript
리스크 점수 = 
  + 미처분잉여금 비중 (최대 25점)
  + 가지급금 비중 (최대 30점)
  + 차명주식 비중 (최대 35점)
  + 부동산 과다 (최대 15점)

레벨:
- 낮음: 0~29점
- 보통: 30~59점
- 높음: 60점 이상
```

---

## 📦 아키텍처

### 파일 구조
```
src/
├── utils/ceo/
│   ├── presets.ts         # 연도별 세율/규정 (2025/2026)
│   ├── math.ts            # 수학 유틸리티
│   ├── taxEngines.ts      # 누진세 계산 엔진
│   ├── valuation.ts       # 주식가치 평가
│   ├── risk.ts            # 리스크 프로파일
│   └── ceoEngine.ts       # 메인 시뮬레이션
│
└── components/
    └── CEOCalculatorV2.tsx # 풀세트 UI
```

### 모듈 설명

#### 1. `presets.ts` - 세율/규정 관리
```typescript
// 연도별 프리셋 (2025, 2026)
type YearKey = 2025 | 2026;

// 법인세
corpEffectiveRate: 0.22  // 유효세율 22%

// 종합소득세 누진표
brackets: [
  { upto: 14_000_000, rate: 0.06, base: 0 },
  { upto: 50_000_000, rate: 0.15, base: 840_000 },
  // ...
]

// 증여/상속세 누진표
brackets: [
  { upto: 100_000_000, rate: 0.10, base: 0 },
  { upto: 500_000_000, rate: 0.20, base: 10_000_000 },
  // ...
]

// 주식평가 가중치
weightNetAsset: 0.4    // 순자산가치 40%
weightEarnings: 0.6    // 수익가치 60%
earningsMultiple: 10   // 환원배수
```

#### 2. `valuation.ts` - 주식가치 평가
```typescript
// 입력
issuedShares: 100_000      // 발행주식수
netAsset: 500_000_000      // 순자산
eps1: 20_000               // 최근 1년 EPS
eps2: 18_000               // 최근 2년 EPS
eps3: 16_000               // 최근 3년 EPS

// 출력
perShareFinal: 7_433       // 1주당 최종 가치
targetValue: 223_000_000   // 평가대상 주식가치
```

#### 3. `taxEngines.ts` - 세금 계산
```typescript
// 누진세 계산
calcProgressiveTax(
  income: 300_000_000,
  brackets: [...]
) → 94_460_000원

// 지방소득세 포함
total = incomeTax + incomeTax * 0.1
```

#### 4. `risk.ts` - 리스크 진단
```typescript
// 입력
retainedEarnings: 300_000_000
officerLoan: 100_000_000
nomineeSharesValue: 0
realEstateValue: 0
netAsset: 500_000_000

// 출력
{
  score: 43,
  level: '보통',
  flags: [
    '미처분잉여금이 중간 이상 수준입니다',
    '가지급금이 존재합니다'
  ],
  actions: [
    '출연/배당/투자 계획을 함께 놓고 주식가치 목표 설정',
    '정리 로드맵(상환, 정산, 급여/복지 구조 전환) 설정'
  ]
}
```

#### 5. `ceoEngine.ts` - 통합 시뮬레이션
```typescript
// 입력
CeoInputs {
  year: 2026,
  issuedShares: 100_000,
  netAsset: 500_000_000,
  contributionAmount: 200_000_000,
  // ... 30+ 필드
}

// 출력
CeoOutputs {
  valuationBefore: { ... },
  valuationAfter: { ... },
  corpTaxSavingAnnual: 44_000_000,
  ownerIncomeTaxSavingAnnual: 15_000_000,
  successionTaxSaving: 50_000_000,
  totalBenefitAnnual: 105_560_000,
  riskProfile: { ... }
}
```

---

## 🎯 사용 방법

### 1. 접속
```
http://3.34.186.174/
```

### 2. 로그인
```
슈퍼 관리자: 01063529091 / (기존 비밀번호)
기업회원/매니저/컨설턴트: 로그인 후 접근 가능
```

### 3. CEO절세계산기 탭 선택
왼쪽 메뉴에서 **👑 CEO절세계산기** 클릭

### 4. 입력 항목

#### ✅ 주식 평가 데이터
- 발행주식수: 예) 100,000주
- 평가(증여/상속) 주식수: 예) 30,000주
- 순자산(자산-부채): 예) 500,000,000원
- 연 사근복 출연 예정액: 예) 200,000,000원
- EPS (최근 3년): 예) 20,000 / 18,000 / 16,000원

#### ✅ 자산/리스크 확장 입력
- 미처분이익잉여금: 예) 300,000,000원
- 가지급금 잔액: 예) 100,000,000원
- 부동산 장부가/시가: 예) 0 / 0원
- 자기주식 보유수량/장부가: 예) 0 / 0
- 차명주식 수량/추정가치: 예) 0 / 0
- ☑️ 부동산 과다보유 (체크 시 순자산 비중 자동 증가)

#### ✅ 승계 설정
- 승계 유형: 증여 / 상속 / 둘다(비교)
- 승계 예정 주식수: 예) 10,000주
- ☑️ 가업승계 특례 사용 (체크 시 공제 한도 입력)

#### ✅ 대표 종합소득세 입력
- 대표 종합소득 과세표준(연): 예) 300,000,000원
- 비용인정률: 50~100% (슬라이더)
- 지급방식 계수: 60~100% (슬라이더)

#### ✅ 출연 시나리오
- 출연 주체: 법인 / 대표 개인 / 제3자
- 출연 자산 유형: 현금 / 자기주식 / 대표 보유 주식 / 차명 주식 / 부동산

### 5. 결과 확인

#### 📊 세금 절감 효과
```
법인세 절감(연): ₩44,000,000
대표 종합소득세 절감(연): ₩15,000,000 (월 ₩1,250,000)
승계세 절감: ₩50,000,000
```

#### 💰 주식가치 변화
```
1주 평가액: ₩7,433 → ₩5,433
평가대상 주식가치: ₩223,000,000 → ₩163,000,000
```

#### ⚡ 총효과
```
총효과(연): ₩105,560,000
(법인세 + 종소세 + 승계세 - 리스크버퍼)
```

#### 🚨 리스크 진단
```
Risk Level: 보통
Score: 43

주요 이슈:
• 미처분잉여금이 중간 이상 수준입니다
• 가지급금이 존재합니다

추천 액션:
• 출연/배당/투자 계획을 함께 놓고 주식가치 목표 설정
• 정리 로드맵(상환, 정산, 급여/복지 구조 전환) 설정
```

---

## ⚠️ 중요 안내

### 시뮬레이션 전제
```
✅ CEO 셀프 의사결정용 시뮬레이션 엔진
✅ 연도별 프리셋으로 세율/규정 관리 (2025/2026)
✅ 법령 변동 시 presets.ts만 수정하면 전체 반영
❌ 실제 세무신고용 아님
❌ 실제 세액은 법령/예규/사실관계/증빙에 따라 달라짐
```

### 실행 전 필수 검토
```
1. 세무전문가 검토
2. 법무 검토 (증여/상속/명의 정리)
3. 증빙 확보 (출연/복지지급)
4. 규정 정비 (복지기금 운영)
```

### 정확도 관리
```
세율/한도: presets.ts에서 연도별 관리
평가방법: valuation.ts에서 가중치 조정
리스크: risk.ts에서 점수화 로직 조정
```

---

## 🔗 관련 링크

- **웹사이트**: http://3.34.186.174/
- **GitHub PR**: https://github.com/masolshop/sagunbok/pull/1
- **커밋**: 29ecd2a

---

## 📝 기술 스택

```
Frontend: React + TypeScript + Tailwind CSS
State: useMemo (실시간 계산)
Build: Vite 6.4.1
Size: 664.44 kB (gzip: 156.36 kB)
```

---

## 🎊 배포 완료!

**CEO 절세계산기 V2가 성공적으로 배포되었습니다!**

이제 다음 단계를 진행하세요:

1. **브라우저 캐시 삭제**: Ctrl + Shift + Delete
2. **웹사이트 접속**: http://3.34.186.174/
3. **로그인**: 회원 계정으로 로그인
4. **CEO절세계산기 탭**: 왼쪽 메뉴에서 선택
5. **데이터 입력**: 예시 데이터 또는 실제 데이터
6. **결과 확인**: 실시간 시뮬레이션 결과

---

**배포 일시**: 2026-01-24 19:15 KST  
**버전**: v6.2.13.2 (CEO Calculator V2)  
**커밋**: 29ecd2a  
**상태**: ✅ 배포 완료 및 테스트 준비
