# 📋 Google Sheets 업데이트 가이드 (v7.2.0)

## 🚨 중요: Google Sheets 구조 변경 필요

기업회원 가입 시 **사업자번호**, **대표자명**, **직함** 필드가 추가되었습니다.  
Google Sheets의 **기업회원** 시트 헤더를 **반드시 업데이트**해야 합니다!

---

## 📊 기업회원 시트 구조 변경

### Before (이전 구조):
```
A: 회사명
B: 기업회원분류
C: 추천인
D: 이름
E: 전화번호
F: 이메일
G: 비밀번호
H: 가입일
I: 승인여부
```

### After (새로운 구조):
```
A: 사업자번호 (NEW!)
B: 회사명
C: 대표자명 (NEW!)
D: 기업회원분류
E: 직함 (NEW!)
F: 이름
G: 전화번호
H: 이메일
I: 비밀번호
J: 가입일
K: 승인여부
L: 추천인 (moved!)
```

---

## 🔧 Google Sheets 수정 방법

### 방법 1: 새 컬럼 삽입 (기존 데이터 보존)

1. **Google Sheets 열기**:
   ```
   https://docs.google.com/spreadsheets/d/1NzBVwAjDTSQWznBapoD1fGspUvXpvQsozdJVSEF5Atc
   ```

2. **기업회원 시트** 선택

3. **컬럼 A 앞에 삽입**:
   - A열 헤더 우클릭
   - "1개 열 왼쪽에 삽입"
   - 새 A열 헤더: `사업자번호`

4. **컬럼 C 뒤에 삽입**:
   - 현재 C열(회사명) 다음
   - "1개 열 오른쪽에 삽입"
   - 새 C열 헤더: `대표자명`

5. **컬럼 E 뒤에 삽입**:
   - 현재 E열(기업회원분류) 다음
   - "1개 열 오른쪽에 삽입"
   - 새 E열 헤더: `직함`

6. **컬럼 L 추가**:
   - 마지막 열(K: 승인여부) 다음
   - "1개 열 오른쪽에 삽입"
   - 새 L열 헤더: `추천인`

7. **기존 C열(추천인) 데이터를 L열로 복사**:
   - 기존 C열의 추천인 데이터를 복사
   - 새 L열에 붙여넣기
   - 기존 C열 데이터 삭제 (헤더는 "대표자명"으로 변경)

8. **최종 헤더 확인**:
   ```
   A: 사업자번호
   B: 회사명
   C: 대표자명
   D: 기업회원분류
   E: 직함
   F: 이름
   G: 전화번호
   H: 이메일
   I: 비밀번호
   J: 가입일
   K: 승인여부
   L: 추천인
   ```

---

### 방법 2: 새 시트 생성 (깨끗하게 시작)

1. **현재 "기업회원" 시트 이름 변경**:
   ```
   기업회원 → 기업회원_OLD
   ```

2. **새 시트 생성**:
   - 이름: `기업회원`

3. **헤더 입력** (첫 번째 행):
   ```
   A: 사업자번호
   B: 회사명
   C: 대표자명
   D: 기업회원분류
   E: 직함
   F: 이름
   G: 전화번호
   H: 이메일
   I: 비밀번호
   J: 가입일
   K: 승인여부
   L: 추천인
   ```

4. **기존 데이터 마이그레이션** (선택사항):
   - 기업회원_OLD 시트에서 데이터 복사
   - 새 컬럼 순서에 맞게 붙여넣기

---

## 📜 Apps Script 업데이트

### 1. Apps Script 에디터 열기
```
확장 프로그램 → Apps Script
```

### 2. 코드 전체 교체
- 기존 코드를 모두 선택 (Ctrl+A / Cmd+A)
- 삭제
- 새 코드 붙여넣기: `APPS_SCRIPT_v7.2.0_BUSINESS_NUMBER.gs`

### 3. 저장 및 배포
```
파일 → 저장 (Ctrl+S / Cmd+S)
배포 → 웹 앱으로 배포
새 배포 → 버전: v7.2.0
```

---

## 🧪 테스트

### 1. 기업회원 가입 테스트
```
https://sagunbok.com
→ 회원가입
→ 🏢 기업 탭
```

#### 입력:
```
사업자번호: 2208162708
[조회] 클릭
→ 회사명: 에스텍시스템 (자동입력)
→ 대표자명: 김철수 (자동입력)

기업회원분류: 법인
직함: 재무담당자
이름: 홍길동
전화번호: 010-9999-8888
이메일: test@example.com
비밀번호: 1234
비밀번호 확인: 1234
추천인: 010-6352-9091
```

#### [회원가입] 클릭

### 2. Google Sheets 확인
```
기업회원 시트 확인:
- A열: 2208162708
- B열: 에스텍시스템
- C열: 김철수
- D열: 법인
- E열: 재무담당자
- F열: 홍길동
- G열: '01099998888
- H열: test@example.com
- I열: 1234
- J열: 2026-01-28 ...
- K열: 승인대기
- L열: '01063529091
```

### 3. 로그 시트 확인
```
로그 시트에 다음 로그 확인:
- 액션: registerCompany
- 상태: SUCCESS
- 메시지: 기업회원 가입 완료: 에스텍시스템
```

---

## ⚠️ 주의사항

1. **Google Sheets 구조 변경을 먼저 완료**하세요!
2. **Apps Script 코드를 업데이트**하세요!
3. **기존 회원 데이터가 있다면** 방법 1(컬럼 삽입)을 사용하세요!
4. **테스트 후 프로덕션 배포**하세요!

---

## 📌 관련 파일

- **Apps Script**: `APPS_SCRIPT_v7.2.0_BUSINESS_NUMBER.gs`
- **Frontend**: `components/Auth.tsx`
- **Backend**: `server/utils/businessNumberLookup.js`
- **React Bundle**: `index-U4Pcccf5.js`
- **Frontend Cache**: v1.0.57

---

## 🔗 Google Sheets 링크

```
https://docs.google.com/spreadsheets/d/1NzBVwAjDTSQWznBapoD1fGspUvXpvQsozdJVSEF5Atc
```

---

**완료 후 다음 단계**: 관리자 승인 → 로그인 테스트 → 프로덕션 확인 ✅
