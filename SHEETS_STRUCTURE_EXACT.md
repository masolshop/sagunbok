# Google Sheets 정확한 구조 가이드

**작성일**: 2026-01-22  
**버전**: 3.0 - 정확한 컬럼 구조

---

## 📊 시트별 정확한 구조

### 시트 1: 기업회원

**10개 컬럼**:
| 컬럼 | 필드명 | 타입 | 설명 | 예시 |
|------|--------|------|------|------|
| A | 회사명 | 텍스트 | 기업명 | AI테스트주식회사 |
| B | 기업회원분류 | 선택 | 개인사업자/법인/병원 | 법인 |
| C | 추천인 | 텍스트 | 사근복 컨설턴트 이름 | 이종근 |
| D | 이름 | 텍스트 | 대표자명 | 홍길동 |
| E | 전화번호 | 텍스트 | 010-xxxx-xxxx | 01099887766 |
| F | 이메일 | 텍스트 | 이메일 주소 | test@example.com |
| G | 비밀번호 | 텍스트 | 로그인 비밀번호 | test1234 |
| H | 가입일 | 날짜시간 | 가입 일시 | 2026-01-22T03:01:33Z |
| I | 승인여부 | 선택 | 승인대기/승인완료/승인거부 | 승인완료 |
| J | 로그기록 | 텍스트 | (사용 안 함 - 별도 시트로 분리) | |

**헤더 행 (1행)**:
```
회사명 | 기업회원분류 | 추천인 | 이름 | 전화번호 | 이메일 | 비밀번호 | 가입일 | 승인여부 | 로그기록
```

**데이터 예시 (2행)**:
```
AI테스트 | 법인 | 이종근 | 홍길동 | 01099887766 | test@example.com | test1234 | 2026-01-22T03:01:33Z | 승인완료 | 
```

---

### 시트 2: 사근복컨설턴트

**10개 컬럼**:
| 컬럼 | 필드명 | 타입 | 설명 | 예시 |
|------|--------|------|------|------|
| A | 이름 | 텍스트 | 컨설턴트 이름 | 이종근 |
| B | 전화번호 | 텍스트 | 010-xxxx-xxxx | 01012345678 |
| C | 이메일 | 텍스트 | 이메일 주소 | lee@sagunbok.com |
| D | 직함 | 텍스트 | 직급/직책 | 수석 컨설턴트 |
| E | 소속사업단 | 텍스트 | 부서명 | 절세솔루션팀 |
| F | 소속지사 | 텍스트 | 지사명 | 서울본사 |
| G | 비밀번호 | 텍스트 | 로그인 비밀번호 | 12345 |
| H | 가입일 | 날짜시간 | 가입 일시 | 2026-01-20T00:00:00Z |
| I | 승인여부 | 선택 | 승인대기/승인완료/승인거부 | 승인완료 |
| J | 로그기록 | 텍스트 | (사용 안 함 - 별도 시트로 분리) | |

**헤더 행 (1행)**:
```
이름 | 전화번호 | 이메일 | 직함 | 소속사업단 | 소속지사 | 비밀번호 | 가입일 | 승인여부 | 로그기록
```

**데이터 예시 (2행)**:
```
이종근 | 01012345678 | lee@sagunbok.com | 수석 컨설턴트 | 절세솔루션팀 | 서울본사 | 12345 | 2026-01-20T00:00:00Z | 승인완료 | 
```

---

### 시트 3: 로그기록 ⭐ 새로 생성

**8개 컬럼**:
| 컬럼 | 필드명 | 타입 | 설명 | 예시 |
|------|--------|------|------|------|
| A | 타임스탬프 | 날짜시간 | 로그 발생 시각 | 2026-01-22T08:30:15Z |
| B | 액션유형 | 텍스트 | 로그인/회원가입/승인/거부 등 | 로그인 |
| C | 사용자유형 | 텍스트 | 기업회원/컨설턴트 | 기업회원 |
| D | 사용자ID | 텍스트 | 전화번호 | 01099887766 |
| E | 상세내용 | 텍스트 | 로그 상세 설명 | 로그인 성공: AI테스트 |
| F | IP주소 | 텍스트 | (선택) IP 주소 | |
| G | 상태 | 텍스트 | 성공/실패 | 성공 |
| H | 에러메시지 | 텍스트 | 실패 시 오류 내용 | |

**헤더 행 (1행)**:
```
타임스탬프 | 액션유형 | 사용자유형 | 사용자ID | 상세내용 | IP주소 | 상태 | 에러메시지
```

**데이터 예시 (2행 이후)**:
```
2026-01-22T08:30:15Z | 로그인 | 기업회원 | 01099887766 | 로그인 성공: AI테스트 | | 성공 | 
2026-01-22T08:32:24Z | 회원가입 | 기업회원 | 01011112222 | 신규 가입: 테스트회사 | | 성공 |
2026-01-22T08:34:07Z | 로그인 | 기업회원 | 01099887766 | 비밀번호 불일치 | | 실패 | 비밀번호가 일치하지 않습니다
```

---

## 🔧 Google Sheets 설정 단계

### 1단계: Google Sheets 열기
```
https://docs.google.com/spreadsheets/d/1NzBVwAjDTSQWznBapoD1fGspUvXpvQsozdJVSEF5Atc/edit
```

---

### 2단계: 기존 시트 정리

#### A. 기업회원 시트 수정

1. **시트 선택**: 기업회원 시트 클릭

2. **J열 (로그기록) 내용 확인**:
   - 로그 데이터가 있다면 나중에 로그기록 시트로 이동
   - 또는 삭제 (새로 생성될 예정)

3. **헤더 확인 (1행)**:
   ```
   A: 회사명
   B: 기업회원분류
   C: 추천인
   D: 이름
   E: 전화번호
   F: 이메일
   G: 비밀번호
   H: 가입일
   I: 승인여부
   J: 로그기록 (비워둠)
   ```

4. **데이터 정리**:
   - J열의 로그 데이터는 모두 삭제
   - 회원 데이터만 남김

---

#### B. 사근복컨설턴트 시트 수정

1. **시트 선택**: 사근복컨설턴트 시트 클릭

2. **J열 (로그기록) 내용 확인**:
   - 로그 데이터 삭제

3. **헤더 확인 (1행)**:
   ```
   A: 이름
   B: 전화번호
   C: 이메일
   D: 직함
   E: 소속사업단
   F: 소속지사
   G: 비밀번호
   H: 가입일
   I: 승인여부
   J: 로그기록 (비워둠)
   ```

4. **데이터 정리**:
   - J열의 로그 데이터는 모두 삭제
   - 컨설턴트 데이터만 남김

---

### 3단계: 로그기록 시트 생성

#### 옵션 1: 수동 생성 (권장)

1. **새 시트 추가**:
   - 시트 하단 왼쪽 `+` 버튼 클릭
   - 또는 기존 시트 탭에서 우클릭 → "시트 삽입"

2. **시트 이름 변경**:
   - 시트 탭에서 우클릭 → "이름 바꾸기"
   - 입력: `로그기록`

3. **헤더 행 입력 (1행)**:
   ```
   A1: 타임스탬프
   B1: 액션유형
   C1: 사용자유형
   D1: 사용자ID
   E1: 상세내용
   F1: IP주소
   G1: 상태
   H1: 에러메시지
   ```

4. **헤더 스타일 적용** (선택):
   - 1행 전체 선택
   - 굵게 (Ctrl+B)
   - 배경색: 연한 회색
   - 텍스트 가운데 정렬

5. **열 너비 조정**:
   ```
   A: 180px (타임스탬프)
   B: 100px (액션유형)
   C: 100px (사용자유형)
   D: 120px (사용자ID)
   E: 250px (상세내용)
   F: 100px (IP주소)
   G: 80px (상태)
   H: 200px (에러메시지)
   ```

---

#### 옵션 2: 자동 생성

- Apps Script가 처음 로그 기록 시 자동으로 생성
- `writeLog` 함수가 시트가 없으면 자동 생성
- 헤더 행도 자동 추가

---

### 4단계: 데이터 검증 설정 (선택)

#### 기업회원 시트

**B열 (기업회원분류) 드롭다운**:
1. B2:B1000 선택
2. 데이터 → 데이터 검증
3. 조건: 목록(범위에서)
4. 항목 입력: `개인사업자,법인,병원`
5. 저장

**I열 (승인여부) 드롭다운**:
1. I2:I1000 선택
2. 데이터 → 데이터 검증
3. 조건: 목록(범위에서)
4. 항목 입력: `승인대기,승인완료,승인거부`
5. 저장

---

#### 사근복컨설턴트 시트

**I열 (승인여부) 드롭다운**:
1. I2:I1000 선택
2. 데이터 → 데이터 검증
3. 조건: 목록(범위에서)
4. 항목 입력: `승인대기,승인완료,승인거부`
5. 저장

---

#### 로그기록 시트

**G열 (상태) 드롭다운**:
1. G2:G10000 선택
2. 데이터 → 데이터 검증
3. 조건: 목록(범위에서)
4. 항목 입력: `성공,실패`
5. 저장

---

## 📝 Apps Script 컬럼 매핑

### 기업회원 시트 (10개 컬럼)

```javascript
// 인덱스:  0        1            2       3     4        5       6         7        8           9
// 컬럼:    A        B            C       D     E        F       G         H        I           J
const row = [회사명, 기업회원분류, 추천인, 이름, 전화번호, 이메일, 비밀번호, 가입일, 승인여부, 로그기록];

// Apps Script에서 접근:
row[0]  // A열: 회사명
row[1]  // B열: 기업회원분류
row[2]  // C열: 추천인
row[3]  // D열: 이름
row[4]  // E열: 전화번호
row[5]  // F열: 이메일
row[6]  // G열: 비밀번호
row[7]  // H열: 가입일
row[8]  // I열: 승인여부
row[9]  // J열: 로그기록 (사용 안 함)
```

---

### 사근복컨설턴트 시트 (10개 컬럼)

```javascript
// 인덱스:  0     1        2       3     4          5        6         7        8           9
// 컬럼:    A     B        C       D     E          F        G         H        I           J
const row = [이름, 전화번호, 이메일, 직함, 소속사업단, 소속지사, 비밀번호, 가입일, 승인여부, 로그기록];

// Apps Script에서 접근:
row[0]  // A열: 이름
row[1]  // B열: 전화번호
row[2]  // C열: 이메일
row[3]  // D열: 직함
row[4]  // E열: 소속사업단
row[5]  // F열: 소속지사
row[6]  // G열: 비밀번호
row[7]  // H열: 가입일
row[8]  // I열: 승인여부
row[9]  // J열: 로그기록 (사용 안 함)
```

---

### 로그기록 시트 (8개 컬럼)

```javascript
// 인덱스:  0          1        2          3        4        5       6     7
// 컬럼:    A          B        C          D        E        F       G     H
const row = [타임스탬프, 액션유형, 사용자유형, 사용자ID, 상세내용, IP주소, 상태, 에러메시지];

// Apps Script에서 접근:
row[0]  // A열: 타임스탬프
row[1]  // B열: 액션유형
row[2]  // C열: 사용자유형
row[3]  // D열: 사용자ID
row[4]  // E열: 상세내용
row[5]  // F열: IP주소
row[6]  // G열: 상태
row[7]  // H열: 에러메시지
```

---

## ✅ 체크리스트

### Google Sheets 준비
- [ ] 1. 기업회원 시트: 헤더 10개 컬럼 확인
- [ ] 2. 기업회원 시트: J열 로그 데이터 삭제
- [ ] 3. 사근복컨설턴트 시트: 헤더 10개 컬럼 확인
- [ ] 4. 사근복컨설턴트 시트: J열 로그 데이터 삭제
- [ ] 5. 로그기록 시트: 새로 생성
- [ ] 6. 로그기록 시트: 헤더 8개 컬럼 입력
- [ ] 7. 데이터 검증 설정 (선택)

### Apps Script 준비
- [ ] 8. Apps Script 에디터 열기
- [ ] 9. 새 코드 붙여넣기 (다음 파일 참조)
- [ ] 10. 저장 및 새 배포

---

## 📚 다음 단계

이제 정확한 컬럼 구조에 맞춘 Apps Script를 작성하겠습니다.

**생성될 파일**:
- `google-apps-script-v3-exact-columns.js`

이 파일은 위의 정확한 컬럼 구조를 반영합니다.

---

## 🎯 주의사항

1. **J열 (로그기록)은 비워둠**:
   - 기업회원과 사근복컨설턴트 시트의 J열은 사용하지 않음
   - 모든 로그는 "로그기록" 시트에 기록됨

2. **컬럼 순서 중요**:
   - Apps Script는 컬럼 인덱스로 접근
   - 순서가 바뀌면 Apps Script도 수정 필요

3. **헤더 행 필수**:
   - 각 시트의 1행은 반드시 헤더 행
   - 데이터는 2행부터 시작

---

**다음**: Apps Script 정확한 컬럼 구조 반영 버전 생성
