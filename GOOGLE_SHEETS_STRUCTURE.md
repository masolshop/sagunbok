# 📊 사근복 AI - Google Sheets 데이터베이스 구조 (최종)

## 스프레드시트 이름
**사근복_회원DB**

---

## 📋 시트 구조

### 시트 1: 기업회원

| 열 | 필드명 | 설명 | 예시 | 필수 | 비고 |
|----|--------|------|------|------|------|
| A | created_at | 가입일시 | 2026-01-20 10:30:00 | O | 자동생성 |
| B | company_name | 회사명 | (주)사근복컨설팅 | O | |
| C | name | 이름 | 홍길동 | O | |
| D | phone | 핸드폰번호 (ID) | 01012345678 | O | **ID로 사용** |
| E | email | 이메일 | hong@company.com | O | |
| F | password | 비밀번호 | user_password | O | 사용자 설정 |
| G | approval_status | 승인상태 | 대기중 / 승인완료 / 거부 | O | 기본값: 대기중 |
| H | last_login | 마지막 로그인 | 2026-01-20 15:30:00 | X | 자동 업데이트 |

**핵심 규칙**:
- **ID**: 핸드폰번호 (D열) - 숫자만, 하이픈 없음 (예: 01012345678)
- **비밀번호**: 사용자 설정 (최소 4자리)
- **승인상태**: 관리자 승인 필요 (대기중 → 승인완료)
- **ID/비밀번호 찾기**: 지원 ✅

---

### 시트 2: 사근복컨설턴트

| 열 | 필드명 | 설명 | 예시 | 필수 | 비고 |
|----|--------|------|------|------|------|
| A | created_at | 가입일시 | 2026-01-20 10:30:00 | O | 자동생성 |
| B | name | 이름 | 김전문 | O | |
| C | phone | 핸드폰번호 (ID) | 01087654321 | O | **ID로 사용** |
| D | email | 이메일 | expert@sagunbok.com | O | |
| E | approval_status | 승인상태 | 대기중 / 승인완료 / 거부 | O | 기본값: 대기중 |
| F | business_unit | 소속 사업단 | 서울사업단 | X | |
| G | branch_office | 소속 지사 | 강남지사 | X | |
| H | position | 직함 | 수석 컨설턴트 | O | |
| I | last_login | 마지막 로그인 | 2026-01-20 15:30:00 | X | 자동 업데이트 |

**핵심 규칙**:
- **ID**: 핸드폰번호 (C열) - 숫자만, 하이픈 없음 (예: 01087654321)
- **비밀번호**: **고정값 "12345"** (가입/로그인 시 항상 동일)
- **승인상태**: 관리자 승인 필요 (대기중 → 승인완료)
- **소속 정보**: 사업단, 지사 (선택 항목)
- **ID/비밀번호 찾기**: 불필요 (비밀번호 고정)

---

### 시트 3: 로그인기록

| 열 | 필드명 | 설명 | 예시 |
|----|--------|------|------|
| A | timestamp | 로그인 시간 | 2026-01-20 15:30:00 |
| B | user_type | 회원 구분 | 기업회원 / 컨설턴트 |
| C | user_id | 사용자 ID (전화번호) | 01012345678 |
| D | user_name | 이름 | 홍길동 |
| E | company_name | 회사명 | (주)사근복컨설팅 |
| F | status | 로그인 결과 | success / failed / pending_approval |
| G | failure_reason | 실패 사유 | 승인대기중 / 비밀번호 오류 |

---

## 🔐 인증 로직 (승인상태 포함)

### 기업회원 회원가입
```
1. 입력: 회사명, 이름, 핸드폰번호, 이메일, 비밀번호
2. 핸드폰번호 중복 체크 (기업회원 시트 D열)
3. 중복 없으면: 새 행 추가
   - 승인상태: "대기중" (기본값)
4. 가입 완료 메시지:
   "회원가입이 완료되었습니다. 관리자 승인 후 로그인 가능합니다."
```

### 기업회원 로그인
```
1. ID 입력: 핸드폰번호 (01012345678)
2. 비밀번호 입력: 사용자 설정 비밀번호
3. "기업회원" 시트에서 전화번호(D열) 조회
4. 비밀번호 검증 (F열과 비교)
5. 승인상태 확인 (G열):
   - "승인완료": 로그인 성공 ✅
   - "대기중": "관리자 승인 대기 중입니다" ⏳
   - "거부": "가입이 거부되었습니다. 관리자에게 문의하세요" ❌
6. 로그인 성공 시: 세션 생성, last_login 업데이트
```

### 사근복컨설턴트 회원가입
```
1. 입력: 이름, 핸드폰번호, 이메일, 직함, (선택: 소속사업단, 소속지사)
2. 비밀번호는 자동으로 "12345" 설정 (UI에서 입력 불필요)
3. 핸드폰번호 중복 체크 (컨설턴트 시트 C열)
4. 중복 없으면: 새 행 추가
   - 승인상태: "대기중" (기본값)
   - 비밀번호: 항상 "12345" (고정)
5. 가입 완료 메시지:
   "회원가입이 완료되었습니다. 관리자 승인 후 로그인 가능합니다.
    로그인 시 비밀번호는 12345를 사용하세요."
```

### 사근복컨설턴트 로그인
```
1. ID 입력: 핸드폰번호 (01087654321)
2. 비밀번호 입력: "12345" (항상 고정)
3. "사근복컨설턴트" 시트에서 전화번호(C열) 조회
4. 비밀번호가 "12345"인지 확인 (항상 통과)
5. 승인상태 확인 (E열):
   - "승인완료": 로그인 성공 ✅
   - "대기중": "관리자 승인 대기 중입니다" ⏳
   - "거부": "가입이 거부되었습니다. 관리자에게 문의하세요" ❌
6. 로그인 성공 시: 세션 생성, last_login 업데이트
```

---

## 🔍 ID/비밀번호 찾기 (기업회원만)

### ID 찾기
```
1. 이름 + 이메일 입력
2. "기업회원" 시트에서 이름(C열) + 이메일(E열) 일치 조회
3. 일치하면: 핸드폰번호(D열) 일부 마스킹 표시
   예: 010****5678
4. 일치 없으면: "일치하는 정보가 없습니다"
```

### 비밀번호 찾기
```
1. 핸드폰번호(ID) + 이메일 입력
2. "기업회원" 시트에서 전화번호(D열) + 이메일(E열) 일치 조회
3. 일치하면: 임시 비밀번호 발급 또는 재설정 화면
4. 일치 없으면: "일치하는 정보가 없습니다"
```

**참고**: 
- 사근복컨설턴트는 비밀번호가 고정("12345")이므로 찾기 기능 불필요
- 컨설턴트는 ID(전화번호)만 찾으면 됨

---

## 👮 승인상태 관리

### 승인 상태 종류
1. **대기중**: 회원가입 직후 기본값
2. **승인완료**: 관리자가 승인 → 로그인 가능
3. **거부**: 관리자가 거부 → 로그인 불가

### 관리자 승인 프로세스
```
1. 관리자가 Google Sheets 직접 접근
2. "기업회원" 또는 "사근복컨설턴트" 시트 열기
3. 승인상태 열(G 또는 E)에서 선택:
   - "대기중" → "승인완료" 변경
   - 또는 "거부" 변경
4. 사용자는 다음 로그인 시 승인 상태 반영
```

### 승인 대기 중 로그인 시도
```
로그인 실패 메시지:
"회원가입 승인 대기 중입니다. 
승인 완료 후 로그인이 가능합니다.
문의: admin@sagunbok.com"
```

---

## 📊 Google Sheets 헤더 구조

### 기업회원 시트
```
A1: 가입일시
B1: 회사명
C1: 이름
D1: 핸드폰번호(ID)
E1: 이메일
F1: 비밀번호
G1: 승인상태
H1: 마지막로그인
```

### 사근복컨설턴트 시트
```
A1: 가입일시
B1: 이름
C1: 핸드폰번호(ID)
D1: 이메일
E1: 승인상태
F1: 소속사업단
G1: 소속지사
H1: 직함
I1: 마지막로그인
```

### 로그인기록 시트
```
A1: 시간
B1: 회원구분
C1: 사용자ID
D1: 이름
E1: 회사명
F1: 상태
G1: 실패사유
```

---

## 📝 샘플 데이터

### 기업회원 샘플
```
Row 2:
A2: 2026-01-20 10:00:00
B2: (주)테스트기업
C2: 홍길동
D2: 01012345678
E2: hong@test.com
F2: test1234
G2: 승인완료
H2: 
```

### 사근복컨설턴트 샘플
```
Row 2:
A2: 2026-01-20 10:00:00
B2: 김전문
C2: 01087654321
D2: expert@sagunbok.com
E2: 승인완료
F2: 서울사업단
G2: 강남지사
H2: 수석 컨설턴트
I2: 
```

---

## 🔑 핵심 차이점 요약

### 기업회원
- ✅ 회사명 필수
- ✅ 사용자가 비밀번호 설정
- ✅ ID/비밀번호 찾기 지원
- ✅ 승인 필요
- ❌ 소속 정보 없음

### 사근복컨설턴트
- ❌ 회사명 없음 (개인)
- ✅ 비밀번호 고정 "12345"
- ❌ 비밀번호 찾기 불필요
- ✅ 승인 필요
- ✅ 소속사업단, 소속지사, 직함

---

## 🚀 다음 단계

1. ✅ Google Sheets 템플릿 생성
2. ⏳ Google Apps Script 웹 앱 구현
   - 회원가입 API (승인상태 "대기중" 설정)
   - 로그인 API (승인상태 확인)
   - ID/비밀번호 찾기 API
3. ⏳ 프론트엔드 UI 개발
   - 회원가입 폼 (기업/컨설턴트 탭 구분)
   - 로그인 폼
   - ID/비밀번호 찾기 폼
4. ⏳ 관리자 대시보드 (승인 관리)

---

**이제 Google Apps Script 코드를 작성하겠습니다!** 🚀
