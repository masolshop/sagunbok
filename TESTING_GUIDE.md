# 🧪 회원가입 & 로그인 테스트 가이드

## 📊 1단계: Google Sheets 설정

### Google Sheets URL
```
https://docs.google.com/spreadsheets/d/1NzBVwAjDTSQWznBapoD1fGspUvXpvQsozdJVSEF5Atc/edit?gid=0#gid=0
```

### 시트 1: 기업회원
헤더 행(1행)에 다음 항목 입력:

| A | B | C | D | E | F | G | H | I | J |
|---|---|---|---|---|---|---|---|---|---|
| 회사명 | 기업회원분류 | 추천인 | 이름 | 전화번호 | 이메일 | 비밀번호 | 가입일 | 승인여부 | 로그기록 |

### 시트 2: 사근복컨설턴트
헤더 행(1행)에 다음 항목 입력:

| A | B | C | D | E | F | G | H | I | J |
|---|---|---|---|---|---|---|---|---|---|
| 이름 | 전화번호 | 이메일 | 직함 | 소속사업단 | 소속지사 | 비밀번호 | 가입일 | 승인여부 | 로그기록 |

### 테스트 컨설턴트 데이터 (2행에 입력)

**사근복컨설턴트 시트의 2행에 다음 데이터를 입력하세요:**

```
A2: 홍길동
B2: 010-8765-4321
C2: hong@sagunbok.com
D2: 수석 컨설턴트
E2: 서울사업단
F2: 강남지사
G2: 12345
H2: 2026-01-21
I2: 승인완료
J2: [2026-01-21] 테스트 계정 생성
```

---

## 🔧 2단계: Google Apps Script 업데이트

### Code-Final.gs 코드 복사
1. `/home/user/webapp/google-apps-script/Code-Final.gs` 파일 내용 전체 복사
2. Google Apps Script 편집기에 붙여넣기
3. 저장 (Ctrl+S)
4. 배포 → 새 배포 → 유형: 웹 앱
5. 실행 사용자: 나
6. 액세스 권한: 모든 사용자
7. 배포 URL 복사

### ✅ 현재 배포된 URL
```
https://script.google.com/macros/s/AKfycbwB26bKC8LI0MVYdmGptMYEXeiD4XtbrI5jsbxWheQbpBstq4ECHGQ_YfrhvEoOFKIM4g/exec
```

---

## 🧪 3단계: 회원가입 테스트

### 테스트 URL
```
https://8000-ibupgf3p7cll7kpgwy3n6-0e616f0a.sandbox.novita.ai
```

### 기업회원 가입 시나리오

#### Step 1: 회원가입 페이지 접속
1. 위의 테스트 URL 접속
2. "회원가입" 탭 클릭
3. "기업회원" 선택 (기본값)

#### Step 2: 정보 입력
```
회사명: 테스트주식회사
기업회원분류: 법인 (드롭다운에서 선택)
추천인: 홍길동 ⭐ (중요! 컨설턴트 시트에 있어야 함)
이름: 김철수
전화번호: 010-1234-5678
이메일: test@company.com
비밀번호: test1234
비밀번호 확인: test1234
```

#### Step 3: 가입 완료
1. "회원가입" 버튼 클릭
2. 성공 메시지 확인: "회원가입이 완료되었습니다. 관리자 승인 후 로그인할 수 있습니다."
3. Google Sheets '기업회원' 시트에 데이터 추가 확인

#### Step 4: 승인 처리
1. Google Sheets '기업회원' 시트 열기
2. 새로 추가된 행의 I열(승인여부) 찾기
3. "대기중" → "승인완료"로 변경
4. 저장 (자동 저장됨)

---

## 🔐 4단계: 로그인 테스트

### 컨설턴트 로그인 (즉시 테스트 가능)

#### Step 1: 로그인 페이지
1. 테스트 URL 접속
2. "로그인" 탭 (기본값)
3. "컨설턴트" 탭 선택

#### Step 2: 로그인 정보 입력
```
전화번호: 010-8765-4321
비밀번호: 12345
```

#### Step 3: 로그인 확인
1. "로그인" 버튼 클릭
2. 성공 시 메인 앱(사근복 절세계산기)으로 이동
3. 왼쪽 사이드바에서 "홍길동" 표시 확인
4. Google Sheets에서 로그기록 업데이트 확인

### 기업회원 로그인 (승인 후 테스트)

#### Step 1: 로그인 페이지
1. 테스트 URL 접속
2. "로그인" 탭 (기본값)
3. "기업회원" 탭 (기본값)

#### Step 2: 로그인 정보 입력
```
전화번호: 010-1234-5678
비밀번호: test1234
```

#### Step 3: 로그인 확인
1. "로그인" 버튼 클릭
2. 성공 시 메인 앱으로 이동
3. 왼쪽 사이드바에서 "김철수" 표시 확인
4. Google Sheets에서 로그기록 업데이트 확인

---

## 🔍 5단계: 검증 테스트

### 추천인 검증 테스트

#### 테스트 케이스 1: 잘못된 추천인
```
추천인: 없는사람
예상 결과: "등록되지 않은 추천인입니다" 오류 메시지
```

#### 테스트 케이스 2: 승인되지 않은 추천인
1. 새 컨설턴트를 시트에 추가 (승인여부: 대기중)
2. 해당 컨설턴트 이름으로 가입 시도
3. 예상 결과: "추천인이 승인되지 않았습니다" 오류 메시지

### 중복 확인 테스트

#### 테스트 케이스 3: 중복 전화번호
```
전화번호: 010-1234-5678 (이미 등록된 번호)
예상 결과: "이미 등록된 전화번호입니다" 오류 메시지
```

#### 테스트 케이스 4: 중복 이메일
```
이메일: test@company.com (이미 등록된 이메일)
예상 결과: "이미 등록된 이메일입니다" 오류 메시지
```

### 승인 시스템 테스트

#### 테스트 케이스 5: 미승인 계정 로그인
1. 새 기업회원 가입 (승인여부: 대기중)
2. 해당 계정으로 로그인 시도
3. 예상 결과: "승인 대기 중인 계정입니다" 오류 메시지

---

## 📊 6단계: 로그 확인

### Google Sheets에서 로그 확인

#### 기업회원 시트 - J열(로그기록)
```
[2026-01-21 16:30:00] 회원가입 완료
[2026-01-21 16:35:00] 로그인 성공
[2026-01-21 16:40:00] 로그인 성공
```

#### 사근복컨설턴트 시트 - J열(로그기록)
```
[2026-01-21] 테스트 계정 생성
[2026-01-21 16:32:00] 로그인 성공
```

---

## ✅ 체크리스트

### Google Sheets 설정
- [ ] '기업회원' 시트 생성 및 헤더 설정
- [ ] '사근복컨설턴트' 시트 생성 및 헤더 설정
- [ ] 테스트 컨설턴트 데이터 입력 (홍길동)
- [ ] 컨설턴트 승인여부 "승인완료"로 설정

### 회원가입 테스트
- [ ] 기업회원 가입 (추천인: 홍길동)
- [ ] Google Sheets에 데이터 저장 확인
- [ ] 승인여부 "대기중"으로 초기화 확인
- [ ] 승인여부를 "승인완료"로 변경

### 로그인 테스트
- [ ] 컨설턴트 로그인 (홍길동)
- [ ] 기업회원 로그인 (김철수)
- [ ] 메인 앱 접속 확인
- [ ] 사용자 이름 표시 확인
- [ ] 로그 기록 업데이트 확인

### 검증 테스트
- [ ] 잘못된 추천인 오류
- [ ] 중복 전화번호 오류
- [ ] 중복 이메일 오류
- [ ] 미승인 계정 로그인 오류

### 로그 시스템
- [ ] 회원가입 로그 기록
- [ ] 로그인 성공 로그 기록
- [ ] 로그인 실패 로그 기록
- [ ] 타임스탬프 포함 확인

---

## 🚨 문제 해결

### 문제 1: "추천인이 존재하지 않습니다" 오류
**해결책:**
1. Google Sheets '사근복컨설턴트' 시트 확인
2. A열에 "홍길동" 정확히 입력되었는지 확인
3. 띄어쓰기, 오타 없는지 확인

### 문제 2: "추천인이 승인되지 않았습니다" 오류
**해결책:**
1. Google Sheets '사근복컨설턴트' 시트 확인
2. I열(승인여부)이 "승인완료"인지 확인
3. "승인완료"로 변경 후 다시 시도

### 문제 3: 로그인 후 메인 앱으로 이동 안 됨
**해결책:**
1. 브라우저 콘솔(F12) 열기
2. 오류 메시지 확인
3. localStorage 확인: `localStorage.getItem('sagunbok_user')`
4. 로그아웃 페이지 사용: `/logout.html`

### 문제 4: Google Apps Script 권한 오류
**해결책:**
1. Apps Script 편집기에서 "프로젝트 설정" 클릭
2. "Google Apps Script API" 활성화
3. 다시 배포 시도

---

## 🎉 성공!

모든 테스트가 통과하면 다음 단계로 진행할 수 있습니다:
1. EC2 배포 준비
2. 운영 환경 설정
3. 실제 사용자 테스트

---

## 📞 지원

문제가 발생하면:
1. Google Sheets 데이터 확인
2. 브라우저 콘솔 로그 확인
3. Google Apps Script 실행 로그 확인 (Apps Script 편집기 → 실행 → 로그)
