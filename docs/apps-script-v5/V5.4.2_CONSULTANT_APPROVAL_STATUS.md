# 🎯 V5.4.2 업데이트: 컨설턴트 승인상태 추가

**작성일**: 2026-01-21 19:00  
**버전**: V5.4.2 FINAL

---

## 📋 변경 요약

사근복컨설턴트 시트에 **I열: 승인상태** 컬럼을 추가했습니다.

---

## 🔄 변경 내용

### **1. Google Sheets 구조 변경**

#### **기존 (V5.4.1):**
```
[사근복컨설턴트] A~H:
A: 이름
B: 핸드폰번호
C: 이메일
D: 직함
E: 소속 사업단
F: 비밀번호
G: 소속 지사
H: 가입일시
```

#### **변경 후 (V5.4.2):**
```
[사근복컨설턴트] A~I:
A: 이름
B: 핸드폰번호
C: 이메일
D: 직함
E: 소속 사업단
F: 비밀번호
G: 소속 지사
H: 가입일시
I: 승인상태  ✨ NEW!
```

---

### **2. Apps Script 변경**

#### **registerConsultant() 함수**

**위치**: Line 428-438

```javascript
sheet.appendRow([
  name,              // A: 이름
  formattedPhone,    // B: 핸드폰번호
  email,             // C: 이메일
  title,             // D: 직함
  department,        // E: 소속 사업단
  password || '12345', // F: 비밀번호
  branch,            // G: 소속 지사
  timestamp,         // H: 가입일시
  '승인전표'         // I: 승인상태 (기본값) ✨ NEW!
]);
```

#### **loginConsultant() 함수**

**위치**: Line 200-233

**변경 1: 읽기 범위 확장**
```javascript
// 기존:
const data = sheet.getRange(2, 1, lastRow - 1, 8).getValues();

// 변경 후:
const data = sheet.getRange(2, 1, lastRow - 1, 9).getValues();  // A~I열 읽기
```

**변경 2: 반환 데이터에 승인상태 추가**
```javascript
return {
  success: true,
  message: '로그인 성공',
  userData: {
    name: row[0],
    phone: formatPhone(row[1]).replace("'", ""),
    email: row[2],
    title: row[3],
    department: row[4],
    branch: row[6],
    registeredAt: row[7],
    approvalStatus: row[8] || '승인전표'  // I: 승인상태 ✨ NEW!
  }
};
```

---

### **3. 문서 업데이트**

- ✅ `APPS_SCRIPT_V5.4_FINAL.js` (V5.4.2)
- ✅ `CLEAN_RESTART_GUIDE.md` 업데이트
- ✅ 헤더 A1~I1에 승인상태 추가
- ✅ 테스트 데이터에 승인전표 추가

---

## 🧪 테스트 방법

### **Step 1: Google Sheets 확인**

1. 사근복컨설턴트 시트 열기
2. **I1 셀**: "승인상태" 헤더 확인
3. **I2~I4 셀**: "승인전표" 값 확인

### **Step 2: 컨설턴트 가입 테스트**

**입력:**
```json
{
  "action": "registerConsultant",
  "data": {
    "name": "테스트컨설턴트",
    "phone": "01099998888",
    "email": "test@consultant.com",
    "title": "대리",
    "department": "테스트사업단",
    "password": "test1234",
    "branch": "테스트지사"
  }
}
```

**결과 확인:**
- I열: "승인전표" 자동 저장

### **Step 3: 컨설턴트 로그인 테스트**

**입력:**
```json
{
  "action": "loginConsultant",
  "data": {
    "phone": "01099998888",
    "password": "test1234"
  }
}
```

**응답 확인:**
```json
{
  "success": true,
  "message": "로그인 성공",
  "userData": {
    "name": "테스트컨설턴트",
    "phone": "010-9999-8888",
    "email": "test@consultant.com",
    "title": "대리",
    "department": "테스트사업단",
    "branch": "테스트지사",
    "registeredAt": "2026-01-21 19:00:00",
    "approvalStatus": "승인전표"  ✨ NEW!
  }
}
```

---

## 📁 업데이트된 파일

```
/home/user/webapp/docs/apps-script-v5/
├── APPS_SCRIPT_V5.4_FINAL.js         (V5.4.2 업데이트)
├── CLEAN_RESTART_GUIDE.md            (I열 승인상태 추가)
└── V5.4.2_CONSULTANT_APPROVAL_STATUS.md  (이 문서)
```

---

## 🎉 완료!

이제 **기업회원**과 **사근복컨설턴트** 모두 **I열에 승인상태**를 저장합니다!

### **시트 구조 통일:**

| 시트 | I열 |
|------|-----|
| 기업회원 | 승인상태 ✅ |
| 사근복컨설턴트 | 승인상태 ✅ |

---

## 📌 다음 단계

1. **Apps Script 배포**
   - 확장 프로그램 → Apps Script
   - 코드 붙여넣기
   - 배포 → 새 배포 → 웹 앱
   - 배포 URL 복사

2. **프록시 서버 업데이트**
   ```bash
   cd /home/user/webapp
   ./quick_update_proxy.sh
   # 새 배포 URL 입력
   ```

3. **브라우저 테스트**
   - http://3.34.186.174
   - 컨설턴트 가입 테스트
   - 로그인 테스트
   - 응답에서 `approvalStatus` 확인

---

**커밋**: `feat: 사근복컨설턴트 시트에 I열 승인상태 추가 (V5.4.2)`
