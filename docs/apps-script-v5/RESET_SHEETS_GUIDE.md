# 🔧 Google Sheets 초기화 가이드

**작성일**: 2026-01-21 18:20  
**목적**: 시트 헤더 수정 및 재생성  

---

## 🚨 문제 상황

**스크린샷 확인 결과**:
- C열 헤더: `0` ← **잘못됨! "기업유형"이어야 함**
- H열 헤더: `추천인` ← 정상 ✅

→ **C열 헤더가 잘못 설정되어 데이터가 저장되지 않음!**

---

## ✅ 해결 방법

### 방법 1: 수동 헤더 수정 (권장 - 2분)

**Google Sheets에서 직접 수정**:

1. 기업회원 시트 열기
2. **1행(헤더)** 수정:

| A | B | C | D | E | F | G | H | I | J | K |
|---|---|---|---|---|---|---|---|---|---|---|
| 가입일시 | 회사명 | **기업유형** | 이름 | 핸드폰번호 | 이메일 | 비밀번호 | 추천인 | 승인상태 | | 마지막로그인 |

3. **C열을 "0"에서 "기업유형"으로 변경**
4. **E열 전체 선택** → 서식 → 숫자 → **일반 텍스트**
5. 2행 이하 기존 데이터 삭제

**완료!** ✅

---

### 방법 2: 스크립트로 자동 재생성 (5분)

**Apps Script 편집기에서 실행**:

#### 1️⃣ 스크립트 추가

1. Google Sheets 열기
2. 확장 프로그램 → Apps Script
3. 새 파일 생성: `RESET_SHEETS.gs`
4. 다음 코드 복사/붙여넣기:

**파일 경로**: `/home/user/webapp/docs/apps-script-v5/RESET_SHEETS.js`

---

#### 2️⃣ 실행 방법

**옵션 A: 전체 초기화 (권장)**

```javascript
// 함수 선택: resetAllSheets
// 실행 버튼 (▶️) 클릭
```

**실행 내용**:
- ✅ 기업회원 시트 재생성 (헤더 포함)
- ✅ 사근복컨설턴트 시트 재생성 (헤더 포함)
- ✅ 테스트 컨설턴트 3명 추가 (김철수, 이영희, 박민수)
- ✅ E열/B열 자동으로 일반 텍스트 설정

**예상 로그**:
```
===== 전체 시트 초기화 시작 =====
기존 "기업회원" 시트 삭제 중...
새 "기업회원" 시트 생성 중...
E열 일반 텍스트 형식 설정 중...
✅ "기업회원" 시트 초기화 완료!
헤더: 가입일시 | 회사명 | 기업유형 | 이름 | 핸드폰번호 | 이메일 | 비밀번호 | 추천인 | 승인상태 |  | 마지막로그인

기존 "사근복컨설턴트" 시트 삭제 중...
새 "사근복컨설턴트" 시트 생성 중...
B열 일반 텍스트 형식 설정 중...
✅ "사근복컨설턴트" 시트 초기화 완료!
헤더: 이름 | 핸드폰번호 | 이메일 | 직함 | 소속 사업단 | 비밀번호 | 소속 지사 | 가입일시

✅ 테스트 컨설턴트 3명 추가 완료!
등록된 이름: 김철수, 이영희, 박민수
===== 전체 시트 초기화 완료 =====
```

---

**옵션 B: 개별 초기화**

1. **기업회원 시트만 초기화**:
   ```javascript
   // 함수 선택: resetCompanySheet
   // 실행 버튼 (▶️) 클릭
   ```

2. **사근복컨설턴트 시트만 초기화**:
   ```javascript
   // 함수 선택: resetConsultantSheet
   // 실행 버튼 (▶️) 클릭
   ```

3. **테스트 데이터만 추가**:
   ```javascript
   // 함수 선택: addTestConsultants
   // 실행 버튼 (▶️) 클릭
   ```

---

## 📊 초기화 후 시트 구조

### [기업회원] 시트

| 열 | 헤더 | 형식 |
|---|------|------|
| A | 가입일시 | 일반 |
| B | 회사명 | 텍스트 |
| **C** | **기업유형** | **텍스트** ✅ |
| D | 이름 | 텍스트 |
| **E** | **핸드폰번호** | **⚠️ 일반 텍스트** |
| F | 이메일 | 텍스트 |
| G | 비밀번호 | 텍스트 |
| **H** | **추천인** | **텍스트** ✅ |
| **I** | **승인상태** | **텍스트** ✅ |
| J | (비어있음) | - |
| K | 마지막로그인 | 일반 |

---

### [사근복컨설턴트] 시트

| 열 | 헤더 | 형식 |
|---|------|------|
| A | 이름 | 텍스트 |
| **B** | **핸드폰번호** | **⚠️ 일반 텍스트** |
| C | 이메일 | 텍스트 |
| D | 직함 | 텍스트 |
| E | 소속 사업단 | 텍스트 |
| F | 비밀번호 | 텍스트 |
| G | 소속 지사 | 텍스트 |
| H | 가입일시 | 일반 |

**테스트 데이터** (자동 추가):

| A | B | C | D | E | F | G | H |
|---|---|---|---|---|---|---|---|
| 김철수 | '010-1234-5678 | kim@sagunbok.com | 팀장 | 서울사업단 | 12345 | 서울지사 | 2026-01-21 ... |
| 이영희 | '010-5678-1234 | lee@sagunbok.com | 과장 | 부산사업단 | 12345 | 부산지사 | 2026-01-21 ... |
| 박민수 | '010-9876-5432 | park@sagunbok.com | 대리 | 대구사업단 | 12345 | 대구지사 | 2026-01-21 ... |

---

## 🎯 초기화 후 테스트

### 브라우저 테스트

**URL**: http://3.34.186.174

**입력 데이터**:
```
회사명: AI테스트병원
기업유형: 병의원개인사업자
담당자: AI테스터
휴대폰: 01099887766
이메일: ai-test@hospital.com
비밀번호: test1234
추천인: 김철수
```

**예상 결과**:
```
✅ "회원가입 신청이 완료되었습니다."
```

**Google Sheets 확인** (기업회원 시트 2행):

| A | B | C | D | E | F | G | H | I |
|---|---|---|---|---|---|---|---|---|
| 2026-01-21 18:25:00 | AI테스트병원 | **병의원개인사업자** | AI테스터 | **'010-9988-7766** | ai-test@hospital.com | test1234 | **김철수** | **승인전표** |

**✅ 확인사항**:
- **C열**: `병의원개인사업자` ← 정상!
- **H열**: `김철수` ← 정상!
- **I열**: `승인전표` ← 정상!
- **E열**: `'010-9988-7766` ← 0 유지!

---

## 📋 체크리스트

### 방법 1: 수동 수정

- [ ] C열 헤더를 "기업유형"으로 변경
- [ ] E열을 "일반 텍스트"로 설정
- [ ] 2행 이하 기존 데이터 삭제
- [ ] 브라우저 테스트

### 방법 2: 스크립트 재생성

- [ ] Apps Script 편집기 열기
- [ ] RESET_SHEETS.gs 파일 생성
- [ ] 코드 복사/붙여넣기
- [ ] resetAllSheets() 실행
- [ ] 로그 확인
- [ ] 브라우저 테스트

---

## 🔗 관련 파일

| 파일 | 경로 |
|-----|------|
| **초기화 스크립트** | `/home/user/webapp/docs/apps-script-v5/RESET_SHEETS.js` |
| **이 가이드** | `/home/user/webapp/docs/apps-script-v5/RESET_SHEETS_GUIDE.md` |

---

## 📞 지원

문제 발생 시:

1. **Apps Script 로그** (Ctrl+Enter)
2. **스크린샷** (시트 헤더)
3. **브라우저 콘솔** (F12)

---

**시트 초기화 가이드!** 🎉

**권장**: 방법 1 (수동 수정) - C열만 "기업유형"으로 변경하면 끝!
